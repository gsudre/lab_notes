<!DOCTYPE html>
<html>
<head>
<title>043-heritability_summary.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family:  "Meiryo", "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

</head>
<body>
<h1 id="2019-09-27-114504">2019-09-27 11:45:04</h1>
<p>This is a summary of the best results in the heritability of change analysis.</p>
<h2 id="overall-qc-approach">Overall QC approach</h2>
<p>We start with a set of kid scans by only analyzing scans under 18 years old.
Then, we define a set of QC variables, and use two methods to determine whether
a particular scan is an outlier: Local Outlier Factor and Isolation Forests. If
a scan is thought to be an outlier in either approach, it's thrown out.</p>
<p>The next step uses the actual brain data for each scan. We employ the same two methods
for outlier detection above, and if any of the scans that survived the previous
QC step is thought to be an outlier, in either of the two methods, it's thrown
out.</p>
<p>The threshold used in each method varied by imaging modality. For DTI I used
95th percentile of data based on the anomaly score, and for fMRI I used 90th
percentile. Those thresholds were chosen to maximize number of subjects so that
SOLAR wouldn't spit out unreasonable values, but at the same time clean the data
as much as possible.</p>
<p>That leaves us with a set of (possibly multiple) clean scans for each subject.
On the next step we select the best two scans for each subject such that there
are at least 6 months between scans.</p>
<p>That last step results in two clean scans per subject. The final step is to
compute the slope for each brain metric and symptom count. That's simply
calculated as (y2-y1)/(t2-t1).</p>
<h3 id="dti-qc">DTI QC</h3>
<p>The QC variables used were:</p>
<pre class="hljs"><code><div>qc_vars = c(<span class="hljs-string">"meanX.trans"</span>, <span class="hljs-string">"meanY.trans"</span>, <span class="hljs-string">"meanZ.trans"</span>,
            <span class="hljs-string">"meanX.rot"</span>, <span class="hljs-string">"meanY.rot"</span>, <span class="hljs-string">"meanZ.rot"</span>,
            <span class="hljs-string">"goodVolumes"</span>)
</div></code></pre>
<p>I also removed any scans that mistakenly used the 80-volume sequence. None of
the QC variables were correlated above abs(.65).</p>
<p>The brain variables used for QC and later heritability and association analysis were the 20 JHU
atlas tracts, AD and RD for each (for a total of 40 variables).</p>
<p>So, we started with 954 kiddie scans, and ended up with 780 after the QC steps.
After reducing it to only two scans per subject, we end up with 504 (252 subjects, 110
ADHD, 145 if including ADHD NOS). Through the results, I refer to the ADHD-only
set as DX1 and ADHD+ADHDNOS as DX2.</p>
<h3 id="rsfmri-qc">rsFMRI QC</h3>
<p>The QC variables used were:</p>
<pre class="hljs"><code><div>qc_vars = c(<span class="hljs-string">'normCoverage'</span>, <span class="hljs-string">'meanDV'</span>, <span class="hljs-string">'pctSpikesDV'</span>,
            <span class="hljs-string">'motionDVCorrInit'</span>,
            <span class="hljs-string">'motionDVCorrFinal'</span>, <span class="hljs-string">"pctSpikesRMS"</span>, <span class="hljs-string">"relMeanRMSMotion"</span>)
</div></code></pre>
<p>They're a subset of all variables that fmriprep spits out. Several variables
were removed to avoid high correlations, simple normalizations of other
variables, etc. None of the QC variables left were correlated above abs(.65).</p>
<p>The brain variables used for QC and later heritability and association analysis
were median postivie connectivity (as measured by Pearson correlation within and
across the following networks: DAN, VAN, DMN, Cognitive, and Limbic. That totals
15 variables. The actual connectivity is computed using a 100 x 100 ROI
connectivity matrix, and each ROI is assigned to a single network. So, the
median positive connectivity is simply collapsing that 100 x 100 matrix across
columns and rows.</p>
<p>So, we started with 764 kiddie scans, and ended up with 521 after the QC steps.
After reducing it to only two scans per subject, we end up with 376 (188 subjects, 75
ADHD, 100 if including ADHD NOS).</p>
<h2 id="results">Results</h2>
<p>I used FDR to correct over the SOLAR heritability p-values, and then ran
association to SX change for those significant tracts (q&lt;.05). In SOLAR, I used
the same QC variables as covariates. SOLAR does its own screening of variables
for the final model, using any variables in the final model that correlate at
p&lt;.1 with the phenotype. I used the same variables SOLAR chose as covariates
when running the associations. In other words, the variables used as covariates
change for the differnet phenotypes. I used LME for associations, with FAMID as
random term.</p>
<h3 id="dti-results">DTI results</h3>
<p><img src="images/2019-09-25-14-04-04.png" alt=""></p>
<p>The first 6 survive FDR:</p>
<p><img src="images/2019-09-25-14-46-02.png" alt=""></p>
<p>rd_18 is associated with SX_HI in the full dataset, SX_HI (and HI baseline) in
DX1 and SX_HI in DX2.</p>
<p>rd_5 is associated with SX_HI in the full dataset, in DX1 and DX2. Also with
inatt_baseline in DX2.</p>
<p>rd_2 is associated with SX_HI in the full dataset, in DX1 and DX2.</p>
<p>ad_2 is associated with SX_HI in the full dataset, and DX2 (DX1 misses it by a
tiny bit).</p>
<p>rd_16 is the first one associated with both SX_HI and SX_inatt in the full
dataset, but it's SX_HI only in DX! and DX2 (SX_inatt is very close in DX2).</p>
<p>ad_10 is associated with SX_HI in the full dataset, and DX2 (DX1 misses it by a
tiny bit).</p>
<ul>
<li>rd_18: Uncinate fasciculus R</li>
<li>rd_5: Cingulum (cingulate gyrus) L</li>
<li>rd_2: Anterior thalamic radiation R</li>
<li>ad_2: Anterior thalamic radiation R</li>
<li>rd_16: Superior longitudinal fasciculus R</li>
<li>ad_10: Forceps minor</li>
</ul>
<p>Let's make a few figures then. I'll only make DX2 figures so we can have an idea
of the data. The full dataset gets quite polluted in the 0 SX slope line because
of NVs, and DX1 is not
always significant.</p>
<p><img src="images/2019-09-27-11-22-43.png" alt=""></p>
<p>Hum... there's someone with a rate of more than 5 SX per year??? Well, there are
no errors according to the scripts. So, unless the DICA spreadsheet is wrong, he
is a real outlier. He's also in the DX1 dataset. But it doesn't look like that
data point is driving all the results, though.</p>
<p><img src="images/2019-09-27-11-39-54.png" alt=""></p>
<p><img src="images/2019-09-27-11-40-45.png" alt=""></p>
<p><img src="images/2019-09-27-11-42-12.png" alt=""></p>
<p><img src="images/2019-09-27-11-42-53.png" alt=""></p>
<p><img src="images/2019-09-27-11-43-34.png" alt=""></p>
<h3 id="rsfmri-results">rsFMRI results</h3>
<p><img src="images/2019-09-27-09-04-27.png" alt=""></p>
<p>The first 2 survive at FDR .05. Let's fly with these results then.</p>
<p>conn_SalVentAttnTODefault
conn_SalVentAttnTOSalVentAttn</p>
<p><img src="images/2019-09-27-10-06-22.png" alt=""></p>
<p>Interesting result with SX_HI in dX2... maybe outlier related?</p>
<p><img src="images/2019-09-27-10-07-49.png" alt=""></p>
<p>Still there even for DX1...</p>
<p>Let's plot it then.</p>
<p><img src="images/2019-09-27-10-17-15.png" alt=""></p>
<p><img src="images/2019-09-27-10-18-06.png" alt=""></p>
<p>First picture is DX1, second is DX2 (includes ADHDNOS).</p>
<p>How about the intra-network connectivity?</p>
<p><img src="images/2019-09-27-10-23-46.png" alt=""></p>
<p>Also associated with SX_HI in DX1</p>
<p><img src="images/2019-09-27-10-24-44.png" alt=""></p>
<p>and DX2.</p>
<p><img src="images/2019-09-27-10-26-15.png" alt=""></p>
<p><img src="images/2019-09-27-10-27-09.png" alt=""></p>
<p>Top figure is DX2 (note that it was significant using LME), and bottom is DX1.</p>

</body>
</html>
